<!DOCTYPE html>
<html lang="en" style="height: 100%;">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>learnJS</title>
    <style>
        body {
            background-color: rgb(30, 30, 60);
            color: white;
            font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
        }
    </style>
</head>

<body id="body" style="display: flex;  margin-top: 10px; padding: 0 40px;">
    <div style="padding-right: 100px;">
        <div id="itemsNumber" style="font-size: 55px;"></div>
        <div id="intervalNumber" style="font-size: 55px;"></div>
        <div>
            <p>Filtrar</p>
            <button id='filter' onclick="filter(true)">Pares</button>
            <button id='filter' onclick="filter(false)">Impares</button>
            <button id='filter' onclick="filter('all')">Todos</button>
            <p>Ordenar</p>
            <div style="display: flex;">
                <div id="ascending">
                    <button id="ascending" onclick="sortArray(true)">Ascendente</button>
                </div>
                <div id="descending">
                    <button id="descending" onclick="sortArray(false)">Descendente</button>
                </div>
            </div>
        </div>
    </div>
    <div style="display: flex; flex-direction: column; justify-content: space-between;">
        <div id="show-items"></div>
        <div id="divButton" style="padding-top: 20px;"></div>
    </div>

    <script>

        // CREATED (Array: [{item & condition]})
        const showItems = document.getElementById('show-items');
        const divButton = document.getElementById('divButton');
        const itemsNumber = document.getElementById('itemsNumber');
        const intervalNumber = document.getElementById('intervalNumber');

        const array = []; // Array to put items;
        const items = Math.floor(Math.random() * 100) + 1;
        const interval = Math.floor(Math.random() * 10) + 15;

        for (i = 0; i < items; i++) {
            const arrayBody = { item: `${(i * Math.floor(Math.random() * 10) + 1)}`, condition: false };
            if (arrayBody.item % 2 == 0) {
                arrayBody.condition = true;
            }
            array.push(arrayBody);
        }
        itemsNumber.innerHTML = `Items: ${items}`;
        intervalNumber.innerHTML = `Intervalo: ${interval}`;

        ///////////////////////
        // FilterArray
        let arrayFiltered = array;
        function filter(filterParam) {
            arrayFiltered = array;
            if (typeof (filterParam) != 'string') {
                function filterArray() {
                    return array.filter(c => {
                        if (filterParam) {
                            return c.condition === true;
                        }
                        else {
                            return c.condition === false;
                        }
                    })
                }
                arrayFiltered = filterArray();
            }
            splitInPages();
            renderItems();
        }

        ///////////////////////
        // SortArray
        function sortArray(clickCondition) {
            arrayFiltered.sort(function (a, b) {
                const itemA = a.item;
                const itemB = b.item;
                const sortSwitch = clickCondition;
                if (sortSwitch) {
                    return itemA - itemB
                } else {
                    return itemB - itemA
                }
            });
            divButton.innerHTML = '';
            splitInPages();
            renderItems();
        }

        ///////////////////////
        // PageSplit
        let arrayFilteredInPages = [];
        function splitInPages() {
            // refresh
            let pageSplit = Math.ceil(arrayFiltered.length / interval);
            arrayFilteredInPages = [];
            firstPoint = 0;
            lastPoint = interval;
            divButton.innerHTML = '';
            //////////
            for (let pageN = 0; pageN < pageSplit; pageN++) {
                let pageBody = { pageNumber: (pageN + 1), items: [] };
                arrayFilteredInPages.push(pageBody);
                for (; firstPoint < lastPoint; firstPoint++) {
                    if (firstPoint == arrayFiltered.length) { break; }
                    const itemBody = { item: '', condition: '' };
                    itemBody.item = arrayFiltered[firstPoint].item;
                    itemBody.condition = arrayFiltered[firstPoint].condition;
                    pageBody.items.push(itemBody);
                }
                lastPoint += interval;
                createButton(arrayFilteredInPages[pageN].pageNumber);
            }
        }
        splitInPages();

        ///////////////////////
        // Creates Buttons
        function createButton(pageNumber) {
            const button = document.createElement('button');
            button.innerHTML = pageNumber;
            button.addEventListener('click', function () {
                renderItems(pageNumber)
            })
            divButton.appendChild(button);
        }

        ///////////////////////
        // Renders Items
        function renderItems(pageNumber) {
            if (!pageNumber) {
                renderPageNumber = 1;
            } else {
                renderPageNumber = pageNumber;
            }
            showItems.innerHTML = '';
            const items = document.createElement('div');
            let currentPage = arrayFilteredInPages[renderPageNumber - 1].items;
            for (i in currentPage) {
                const eachItem = document.createElement('div');
                eachItem.innerHTML = currentPage[i].item;
                items.appendChild(eachItem);
            }
            showItems.appendChild(items);
        }
        renderItems();

    </script>
</body>

</html>