<!DOCTYPE html>
<html lang="en" style="height: 100%;">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>learnJS</title>
    <style>
        body {
            background-color: rgb(30, 30, 60);
            color: white;
            font-family: 'Franklin Gothic Medium', 'Arial Narrow', Arial, sans-serif;
        }
    </style>
</head>

<body id="body" style="display: flex;  margin-top: 10px; padding: 0 40px;">
    <div style="padding-right: 100px;">
        <div id="itemsNumber" style="font-size: 55px;"></div>
        <div id="intervalNumber" style="font-size: 55px;"></div>
        <div >
            <p>Ordenar</p>
                <div style="display: flex;">
                    <div id="ascending">
                        <button id="ascending" onclick="sortAscending()">Ascendente</button>
                    </div>
                    <div id="descending">
                        <button id="descending" onclick="sortDescending()">Descendente</button>
                    </div>
                </div>
        </div>
    </div>
    <div style="display: flex; flex-direction: column; justify-content: space-between;">
        <div id="show-items"></div>
        <div id="divButton" style="padding-top: 20px;"></div>
    </div>

    <script>
        // HTML
        const showItems = document.getElementById('show-items');
        const divButton = document.getElementById('divButton');

        // Array and Interval

        const itemsNumber = document.getElementById('itemsNumber');
        const intervalNumber = document.getElementById('intervalNumber');

        let array;
        let interval;
        let items;

        let start = true;
        if (true) {
            array = []; // Array to put items
            interval = Math.floor(Math.random() * 10) + 15;
            items = Math.floor(Math.random() * 100) + 1;
            for (i = 0; i < items; i++) {
                array.push(`${(i * Math.floor(Math.random() * 10) + 1)}`); // Push in Array a random items
            }
        }
        start = false;

        itemsNumber.innerHTML = `Items: ${items}`;
        intervalNumber.innerHTML = `Intervalo: ${interval}`;

        let startInterval = 0;
        let endInterval = interval;

        // Pages from intervals
        const pageSplit = Math.ceil(array.length / interval); // Split items in pages according interval

        let buttonAssigend = false;
        function sortAscending() {
            array.sort(function (a, b) { return a - b });
            loop();
            buttonAssigend = false;
            renderItems();
            buttons();
        }
        function sortDescending() {
            array.sort(function (a, b) { return b - a });
            loop();
            buttonAssigend = false;
            renderItems();
            buttons();
        }

        // Create page
        let pages;
        let pageItems;
        let pageNumber;
        let obj;
        function loop() {
            let startInterval = 0;
            let endInterval = interval;
            pages = []; // Array to put object with PageNumber and Items splited
            for (pageNumber = 1; pageNumber < (pageSplit + 1); pageNumber++) { // (+ 1): Catchs leftovers items and add a page
                obj = { pageNumber: pageNumber, items: [] }; // HERE IS THE TRICK (creates an object to put into an array to link (with pageNumber (id)) in every listener)
                pages.push(obj);

                // For every page created: adds the items splitted
                for (; startInterval < endInterval; startInterval++) { // Complets the loop according interval
                    if (startInterval == array.length) { break; }
                    obj.items.push(array[startInterval]); // Pushs the looped items
                }
                endInterval += interval; // Updates endInterval
            }
        }
        loop();

        function renderItems() {
            for (pageNumber = 1; pageNumber < (pageSplit + 1); pageNumber++) {
                let domStart = pages[0].items; // Render first page
                if (!buttonAssigend) {
                    pageItems = domStart;
                }
                let domButton = pages[pageNumber - 1].items; // Separate items according to that page (on click)
                let itemsDiv = document.createElement('div');
                for (item in pageItems) {
                    let eachItem = document.createElement('div');
                    eachItem.innerHTML = pageItems[item];
                    itemsDiv.appendChild(eachItem);
                }
                showItems.innerHTML = ''; // Resets showItems
                showItems.appendChild(itemsDiv);
            }
        }
        renderItems();

        function buttons() {
            divButton.innerHTML = '';
            for (pageNumber = 1; pageNumber < (pageSplit + 1); pageNumber++) {
                let domButton = pages[pageNumber - 1].items; // Separate items according to that page (on click)

                let button;
                button = document.createElement('button'); // Creates and assign button according page,   
                button.innerHTML = pages[pageNumber - 1].pageNumber; // -1 to acces the index 0
                button.addEventListener('click', function () {
                    pageItems = domButton;
                    buttonAssigend = true;
                    renderItems();
                })
                divButton.appendChild(button);
            }
        }
        buttons();
    </script>
</body>

</html>